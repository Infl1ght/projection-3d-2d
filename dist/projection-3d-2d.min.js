var Projection3d2d;(()=>{var t={497:(t,r,e)=>{function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var e=[],n=!0,o=!1,i=void 0;try{for(var u,s=t[Symbol.iterator]();!(n=(u=s.next()).done)&&(e.push(u.value),!r||e.length!==r);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return e}}(t,r)||function(t,r){if(t){if("string"==typeof t)return i(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?i(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function u(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,r,e){return r&&u(t.prototype,r),e&&u(t,e),t}function a(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&c(t,r)}function c(t,r){return(c=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function f(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,n=h(t);if(r){var o=h(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return l(this,e)}}function l(t,r){return!r||"object"!==n(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}var p=e(581),v=p.Matrix,m=p.SingularValueDecomposition,b=p.inverse,w=p.solve,g="See example: https://github.com/Infl1ght/projection-3d-2d#example-2d-to-2d",d=function t(r,e){if(y(this,t),!r||!e)throw new Error("Two arrays with points must be provided. "+g);if(r.length!==e.length)throw new Error("Lengths of point arrays must be equal. "+g);this.points3d=r,this.points2d=e},x=function(t){a(e,t);var r=f(e);function e(t,n){var o;if(y(this,e),o=r.call(this,t,n),t.length<6)throw new Error("6 points must be provided for ProjectionCalculator3d. "+g);return o.calculateMatrix(),o}return s(e,[{key:"calculateMatrix",value:function(){for(var t=new v(2*this.points2d.length,12),r=0,e=0;e<this.points3d.length;e+=1){var n=o(this.points3d[e],3);t[r][0]=n[0],t[r][1]=n[1],t[r][2]=n[2],t[r][3]=1,t[r][4]=0,t[r][5]=0,t[r][6]=0,t[r][7]=0,t[r][8]=-this.points3d[e][0]*this.points2d[e][0],t[r][9]=-this.points3d[e][1]*this.points2d[e][0],t[r][10]=-this.points3d[e][2]*this.points2d[e][0],t[r][11]=-this.points2d[e][0],t[r+1][0]=0,t[r+1][1]=0,t[r+1][2]=0,t[r+1][3]=0;var i=o(this.points3d[e],3);t[r+1][4]=i[0],t[r+1][5]=i[1],t[r+1][6]=i[2],t[r+1][7]=1,t[r+1][8]=-this.points3d[e][0]*this.points2d[e][1],t[r+1][9]=-this.points3d[e][1]*this.points2d[e][1],t[r+1][10]=-this.points3d[e][2]*this.points2d[e][1],t[r+1][11]=-this.points2d[e][1],r+=2}var u=new m(t),s=new v(u.V).transpose().subMatrix(11,11,0,11)[0];this.resultMatrix=new v([[s[0],s[1],s[2],s[3]],[s[4],s[5],s[6],s[7]],[s[8],s[9],s[10],s[11]],[0,0,0,1]]),this.resultMatrixInversed=b(this.resultMatrix)}},{key:"getProjectedPoint",value:function(t){var r=v.columnVector([t[0],t[1],t[2],1]),e=this.resultMatrix.mmul(r);return[e[0]/e[2],e[1]/e[2]]}},{key:"getUnprojectedPoint",value:function(t,r){if(void 0===r)throw new Error("Point height must be defined for 3d unprojection");var n=v.columnVector([t[0],t[1],1,1]),o=v.columnVector([100*t[0],100*t[1],100,1]),i=this.resultMatrixInversed.mmul(n),u=this.resultMatrixInversed.mmul(o);return e.getIntersectionLineAndPlane(i,u,[0,0,r],[0,10,r],[10,0,r])}}],[{key:"getIntersectionLineAndPlane",value:function(t,r,e,n,o){var i=(n[1]-e[1])*(o[2]-e[2])-(n[2]-e[2])*(o[1]-e[1]),u=(n[2]-e[2])*(o[0]-e[0])-(n[0]-e[0])*(o[2]-e[2]),s=(n[0]-e[0])*(o[1]-e[1])-(n[1]-e[1])*(o[0]-e[0]),a=i*e[0]+u*e[1]+s*e[2],c=r[0]-t[0],f=r[1]-t[1],l=r[2]-t[2],h=c*t[1]-f*t[0],y=c*t[2]-l*t[0],p=(c*a-h*u-y*s)/(c*i+f*u+l*s);return[p,(f*p+h)/c,(l*p+y)/c]}}]),e}(d),M=function(t){a(e,t);var r=f(e);function e(t,n){var o;if(y(this,e),o=r.call(this,t,n),t.length<4)throw new Error("4 points must be provided for ProjectionCalculator3d. "+g);return o.calculateMatrix(),o}return s(e,[{key:"calculateMatrix",value:function(){for(var t=new v(2*this.points2d.length,8),r=new v(8,1),e=0,n=0;n<this.points3d.length;n+=1){var i=o(this.points3d[n],2);t[e][0]=i[0],t[e][1]=i[1],t[e][2]=1,t[e][3]=0,t[e][4]=0,t[e][5]=0,t[e][6]=-this.points3d[n][0]*this.points2d[n][0],t[e][7]=-this.points3d[n][1]*this.points2d[n][0];var u=o(this.points2d[n],1);r[e][0]=u[0],t[e+1][0]=0,t[e+1][1]=0,t[e+1][2]=0;var s=o(this.points3d[n],2);t[e+1][3]=s[0],t[e+1][4]=s[1],t[e+1][5]=1,t[e+1][6]=-this.points3d[n][0]*this.points2d[n][1],t[e+1][7]=-this.points3d[n][1]*this.points2d[n][1];var a=o(this.points2d[n],2);r[e+1][0]=a[1],e+=2}var c=w(t,r);this.resultMatrix=new v([[c[0][0],c[1][0],c[2][0]],[c[3][0],c[4][0],c[5][0]],[c[6][0],c[7][0],1]]),this.resultMatrixInversed=b(this.resultMatrix)}},{key:"getProjectedPoint",value:function(t){var r=v.columnVector([t[0],t[1],1]),e=this.resultMatrix.mmul(r);return[e[0]/e[2],e[1]/e[2]]}},{key:"getUnprojectedPoint",value:function(t){var r=v.columnVector([t[0],t[1],1]),e=this.resultMatrixInversed.mmul(r);return[e[0]/e[2],e[1]/e[2]]}}]),e}(d);t.exports.ProjectionCalculator3d=x,t.exports.ProjectionCalculator2d=M},581:(t,r,e)=>{"use strict";e.r(r),e.d(r,{CHO:()=>Or,CholeskyDecomposition:()=>Or,EVD:()=>br,EigenvalueDecomposition:()=>br,LU:()=>c,LuDecomposition:()=>c,Matrix:()=>$t,QR:()=>cr,QrDecomposition:()=>cr,SVD:()=>p,SingularValueDecomposition:()=>p,WrapperMatrix1D:()=>tr,WrapperMatrix2D:()=>ur,abstractMatrix:()=>Nt,default:()=>$t,inverse:()=>fr,linearDependencies:()=>pr,solve:()=>lr,wrap:()=>sr});var n=Object.prototype.toString;function o(t){return n.call(t).endsWith("Array]")}const i=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var e=r.fromIndex,n=void 0===e?0:e,i=r.toIndex,u=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(u<=n||u>t.length||!Number.isInteger(u))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[n],a=n+1;a<u;a++)t[a]>s&&(s=t[a]);return s},u=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var e=r.fromIndex,n=void 0===e?0:e,i=r.toIndex,u=void 0===i?t.length:i;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(u<=n||u>t.length||!Number.isInteger(u))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var s=t[n],a=n+1;a<u;a++)t[a]<s&&(s=t[a]);return s},s=function(t){var r,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==e.output){if(!o(e.output))throw new TypeError("output option must be an array if specified");r=e.output}else r=new Array(t.length);var n=u(t),s=i(t);if(n===s)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var a=e.min,c=void 0===a?e.autoMinMax?n:0:a,f=e.max,l=void 0===f?e.autoMinMax?s:1:f;if(c>=l)throw new RangeError("min option must be smaller than max option");for(var h=(l-c)/(s-n),y=0;y<t.length;y++)r[y]=(t[y]-n)*h+c;return r};function a(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(){function t(r){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t);var e,n,o,i,u,s,a,c,f,l=(r=ur.checkMatrix(r)).clone(),h=l.rows,y=l.columns,p=new Array(h),v=1;for(e=0;e<h;e++)p[e]=e;for(c=new Array(h),n=0;n<y;n++){for(e=0;e<h;e++)c[e]=l.get(e,n);for(e=0;e<h;e++){for(f=Math.min(e,n),u=0,o=0;o<f;o++)u+=l.get(e,o)*c[o];c[e]-=u,l.set(e,n,c[e])}for(i=n,e=n+1;e<h;e++)Math.abs(c[e])>Math.abs(c[i])&&(i=e);if(i!==n){for(o=0;o<y;o++)s=l.get(i,o),l.set(i,o,l.get(n,o)),l.set(n,o,s);a=p[i],p[i]=p[n],p[n]=a,v=-v}if(n<h&&0!==l.get(n,n))for(e=n+1;e<h;e++)l.set(e,n,l.get(e,n)/l.get(n,n))}this.LU=l,this.pivotVector=p,this.pivotSign=v}var r,e;return r=t,(e=[{key:"isSingular",value:function(){for(var t=this.LU,r=t.columns,e=0;e<r;e++)if(0===t[e][e])return!0;return!1}},{key:"solve",value:function(t){t=$t.checkMatrix(t);var r=this.LU;if(r.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var e,n,o,i=t.columns,u=t.subMatrixRow(this.pivotVector,0,i-1),s=r.columns;for(o=0;o<s;o++)for(e=o+1;e<s;e++)for(n=0;n<i;n++)u[e][n]-=u[o][n]*r[e][o];for(o=s-1;o>=0;o--){for(n=0;n<i;n++)u[o][n]/=r[o][o];for(e=0;e<o;e++)for(n=0;n<i;n++)u[e][n]-=u[o][n]*r[e][o]}return u}},{key:"determinant",get:function(){var t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");for(var r=this.pivotSign,e=t.columns,n=0;n<e;n++)r*=t[n][n];return r}},{key:"lowerTriangularMatrix",get:function(){for(var t=this.LU,r=t.rows,e=t.columns,n=new $t(r,e),o=0;o<r;o++)for(var i=0;i<e;i++)n[o][i]=o>i?t[o][i]:o===i?1:0;return n}},{key:"upperTriangularMatrix",get:function(){for(var t=this.LU,r=t.rows,e=t.columns,n=new $t(r,e),o=0;o<r;o++)for(var i=0;i<e;i++)n[o][i]=o<=i?t[o][i]:0;return n}},{key:"pivotPermutationVector",get:function(){return this.pivotVector.slice()}}])&&a(r.prototype,e),t}();function f(t,r){var e=0;return Math.abs(t)>Math.abs(r)?(e=r/t,Math.abs(t)*Math.sqrt(1+e*e)):0!==r?(e=t/r,Math.abs(r)*Math.sqrt(1+e*e)):0}function l(t,r,e){for(var n=new Array(t),o=0;o<t;o++){n[o]=new Array(r);for(var i=0;i<r;i++)n[o][i]=e}return n}function h(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function y(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var p=function(){function t(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};h(this,t);var n,o=(r=ur.checkMatrix(r)).rows,i=r.columns,u=e.computeLeftSingularVectors,s=void 0===u||u,a=e.computeRightSingularVectors,c=void 0===a||a,y=e.autoTranspose,p=void 0!==y&&y,v=Boolean(s),m=Boolean(c),b=!1;if(o<i)if(p){o=(n=r.transpose()).rows,i=n.columns,b=!0;var w=v;v=m,m=w}else n=r.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else n=r.clone();for(var g=Math.min(o,i),d=Math.min(o+1,i),x=new Array(d),M=l(o,g,0),k=l(i,i,0),O=new Array(i),S=new Array(o),R=new Array(d),j=0;j<d;j++)R[j]=j;for(var E=Math.min(o-1,i),_=Math.max(0,Math.min(i-2,o)),P=Math.max(E,_),V=0;V<P;V++){if(V<E){x[V]=0;for(var A=V;A<o;A++)x[V]=f(x[V],n[A][V]);if(0!==x[V]){n[V][V]<0&&(x[V]=-x[V]);for(var C=V;C<o;C++)n[C][V]/=x[V];n[V][V]+=1}x[V]=-x[V]}for(var I=V+1;I<i;I++){if(V<E&&0!==x[V]){for(var T=0,B=V;B<o;B++)T+=n[B][V]*n[B][I];T=-T/n[V][V];for(var q=V;q<o;q++)n[q][I]+=T*n[q][V]}O[I]=n[V][I]}if(v&&V<E)for(var D=V;D<o;D++)M[D][V]=n[D][V];if(V<_){O[V]=0;for(var N=V+1;N<i;N++)O[V]=f(O[V],O[N]);if(0!==O[V]){O[V+1]<0&&(O[V]=0-O[V]);for(var L=V+1;L<i;L++)O[L]/=O[V];O[V+1]+=1}if(O[V]=-O[V],V+1<o&&0!==O[V]){for(var U=V+1;U<o;U++)S[U]=0;for(var z=V+1;z<o;z++)for(var Q=V+1;Q<i;Q++)S[z]+=O[Q]*n[z][Q];for(var F=V+1;F<i;F++)for(var W=-O[F]/O[V+1],H=V+1;H<o;H++)n[H][F]+=W*S[H]}if(m)for(var $=V+1;$<i;$++)k[$][V]=O[$]}}var G=Math.min(i,o+1);if(E<i&&(x[E]=n[E][E]),o<G&&(x[G-1]=0),_+1<G&&(O[_]=n[_][G-1]),O[G-1]=0,v){for(var J=E;J<g;J++){for(var K=0;K<o;K++)M[K][J]=0;M[J][J]=1}for(var X=E-1;X>=0;X--)if(0!==x[X]){for(var Y=X+1;Y<g;Y++){for(var Z=0,tt=X;tt<o;tt++)Z+=M[tt][X]*M[tt][Y];Z=-Z/M[X][X];for(var rt=X;rt<o;rt++)M[rt][Y]+=Z*M[rt][X]}for(var et=X;et<o;et++)M[et][X]=-M[et][X];M[X][X]=1+M[X][X];for(var nt=0;nt<X-1;nt++)M[nt][X]=0}else{for(var ot=0;ot<o;ot++)M[ot][X]=0;M[X][X]=1}}if(m)for(var it=i-1;it>=0;it--){if(it<_&&0!==O[it])for(var ut=it+1;ut<i;ut++){for(var st=0,at=it+1;at<i;at++)st+=k[at][it]*k[at][ut];st=-st/k[it+1][it];for(var ct=it+1;ct<i;ct++)k[ct][ut]+=st*k[ct][it]}for(var ft=0;ft<i;ft++)k[ft][it]=0;k[it][it]=1}for(var lt=G-1,ht=Number.EPSILON;G>0;){var yt=void 0,pt=void 0;for(yt=G-2;yt>=-1&&-1!==yt;yt--){var vt=Number.MIN_VALUE+ht*Math.abs(x[yt]+Math.abs(x[yt+1]));if(Math.abs(O[yt])<=vt||Number.isNaN(O[yt])){O[yt]=0;break}}if(yt===G-2)pt=4;else{var mt=void 0;for(mt=G-1;mt>=yt&&mt!==yt;mt--){var bt=(mt!==G?Math.abs(O[mt]):0)+(mt!==yt+1?Math.abs(O[mt-1]):0);if(Math.abs(x[mt])<=ht*bt){x[mt]=0;break}}mt===yt?pt=3:mt===G-1?pt=1:(pt=2,yt=mt)}switch(yt++,pt){case 1:var wt=O[G-2];O[G-2]=0;for(var gt=G-2;gt>=yt;gt--){var dt=f(x[gt],wt),xt=x[gt]/dt,Mt=wt/dt;if(x[gt]=dt,gt!==yt&&(wt=-Mt*O[gt-1],O[gt-1]=xt*O[gt-1]),m)for(var kt=0;kt<i;kt++)dt=xt*k[kt][gt]+Mt*k[kt][G-1],k[kt][G-1]=-Mt*k[kt][gt]+xt*k[kt][G-1],k[kt][gt]=dt}break;case 2:var Ot=O[yt-1];O[yt-1]=0;for(var St=yt;St<G;St++){var Rt=f(x[St],Ot),jt=x[St]/Rt,Et=Ot/Rt;if(x[St]=Rt,Ot=-Et*O[St],O[St]=jt*O[St],v)for(var _t=0;_t<o;_t++)Rt=jt*M[_t][St]+Et*M[_t][yt-1],M[_t][yt-1]=-Et*M[_t][St]+jt*M[_t][yt-1],M[_t][St]=Rt}break;case 3:var Pt=Math.max(Math.abs(x[G-1]),Math.abs(x[G-2]),Math.abs(O[G-2]),Math.abs(x[yt]),Math.abs(O[yt])),Vt=x[G-1]/Pt,At=x[G-2]/Pt,Ct=O[G-2]/Pt,It=x[yt]/Pt,Tt=O[yt]/Pt,Bt=((At+Vt)*(At-Vt)+Ct*Ct)/2,qt=Vt*Ct*(Vt*Ct),Dt=0;0===Bt&&0===qt||(Dt=qt/(Bt+(Dt=Bt<0?0-Math.sqrt(Bt*Bt+qt):Math.sqrt(Bt*Bt+qt))));for(var Nt=(It+Vt)*(It-Vt)+Dt,Lt=It*Tt,Ut=yt;Ut<G-1;Ut++){var zt=f(Nt,Lt);0===zt&&(zt=Number.MIN_VALUE);var Qt=Nt/zt,Ft=Lt/zt;if(Ut!==yt&&(O[Ut-1]=zt),Nt=Qt*x[Ut]+Ft*O[Ut],O[Ut]=Qt*O[Ut]-Ft*x[Ut],Lt=Ft*x[Ut+1],x[Ut+1]=Qt*x[Ut+1],m)for(var Wt=0;Wt<i;Wt++)zt=Qt*k[Wt][Ut]+Ft*k[Wt][Ut+1],k[Wt][Ut+1]=-Ft*k[Wt][Ut]+Qt*k[Wt][Ut+1],k[Wt][Ut]=zt;if(0===(zt=f(Nt,Lt))&&(zt=Number.MIN_VALUE),Qt=Nt/zt,Ft=Lt/zt,x[Ut]=zt,Nt=Qt*O[Ut]+Ft*x[Ut+1],x[Ut+1]=-Ft*O[Ut]+Qt*x[Ut+1],Lt=Ft*O[Ut+1],O[Ut+1]=Qt*O[Ut+1],v&&Ut<o-1)for(var Ht=0;Ht<o;Ht++)zt=Qt*M[Ht][Ut]+Ft*M[Ht][Ut+1],M[Ht][Ut+1]=-Ft*M[Ht][Ut]+Qt*M[Ht][Ut+1],M[Ht][Ut]=zt}O[G-2]=Nt;break;case 4:if(x[yt]<=0&&(x[yt]=x[yt]<0?-x[yt]:0,m))for(var $t=0;$t<=lt;$t++)k[$t][yt]=-k[$t][yt];for(;yt<lt&&!(x[yt]>=x[yt+1]);){var Gt=x[yt];if(x[yt]=x[yt+1],x[yt+1]=Gt,m&&yt<i-1)for(var Jt=0;Jt<i;Jt++)Gt=k[Jt][yt+1],k[Jt][yt+1]=k[Jt][yt],k[Jt][yt]=Gt;if(v&&yt<o-1)for(var Kt=0;Kt<o;Kt++)Gt=M[Kt][yt+1],M[Kt][yt+1]=M[Kt][yt],M[Kt][yt]=Gt;yt++}G--}}if(b){var Xt=k;k=M,M=Xt}this.m=o,this.n=i,this.s=x,this.U=M,this.V=k}var r,e;return r=t,(e=[{key:"solve",value:function(t){for(var r=t,e=this.threshold,n=this.s.length,o=$t.zeros(n,n),i=0;i<n;i++)Math.abs(this.s[i])<=e?o[i][i]=0:o[i][i]=1/this.s[i];for(var u=this.U,s=this.rightSingularVectors,a=s.mmul(o),c=s.rows,f=u.length,l=$t.zeros(c,f),h=0;h<c;h++)for(var y=0;y<f;y++){for(var p=0,v=0;v<n;v++)p+=a[h][v]*u[y][v];l[h][y]=p}return l.mmul(r)}},{key:"solveForDiagonal",value:function(t){return this.solve($t.diag(t))}},{key:"inverse",value:function(){for(var t=this.V,r=this.threshold,e=t.length,n=t[0].length,o=new $t(e,this.s.length),i=0;i<e;i++)for(var u=0;u<n;u++)Math.abs(this.s[u])>r?o[i][u]=t[i][u]/this.s[u]:o[i][u]=0;for(var s=this.U,a=s.length,c=s[0].length,f=new $t(e,a),l=0;l<e;l++)for(var h=0;h<a;h++){for(var y=0,p=0;p<c;p++)y+=o[l][p]*s[h][p];f[l][h]=y}return f}},{key:"condition",get:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}},{key:"norm2",get:function(){return this.s[0]}},{key:"rank",get:function(){for(var t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,r=0,e=this.s,n=0,o=e.length;n<o;n++)e[n]>t&&r++;return r}},{key:"diagonal",get:function(){return this.s}},{key:"threshold",get:function(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}},{key:"leftSingularVectors",get:function(){return $t.isMatrix(this.U)||(this.U=new $t(this.U)),this.U}},{key:"rightSingularVectors",get:function(){return $t.isMatrix(this.V)||(this.V=new $t(this.V)),this.V}},{key:"diagonalMatrix",get:function(){return $t.diag(this.s)}}])&&y(r.prototype,e),t}();function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,r,e){var n=e?t.rows:t.rows-1;if(r<0||r>n)throw new RangeError("Row index out of range")}function b(t,r,e){var n=e?t.columns:t.columns-1;if(r<0||r>n)throw new RangeError("Column index out of range")}function w(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return r}function g(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return r}function d(t,r,e){return{row:x(t,r),column:M(t,e)}}function x(t,r){if("object"!==v(r))throw new TypeError("unexpected type for row indices");if(r.some((function(r){return r<0||r>=t.rows})))throw new RangeError("row indices are out of range");return Array.isArray(r)||(r=Array.from(r)),r}function M(t,r){if("object"!==v(r))throw new TypeError("unexpected type for column indices");if(r.some((function(r){return r<0||r>=t.columns})))throw new RangeError("column indices are out of range");return Array.isArray(r)||(r=Array.from(r)),r}function k(t,r,e,n,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(R("startRow",r),R("endRow",e),R("startColumn",n),R("endColumn",o),r>e||n>o||r<0||r>=t.rows||e<0||e>=t.rows||n<0||n>=t.columns||o<0||o>=t.columns)throw new RangeError("Submatrix indices are out of range")}function O(t){for(var r=$t.zeros(t.rows,1),e=0;e<t.rows;++e)for(var n=0;n<t.columns;++n)r.set(e,0,r.get(e,0)+t.get(e,n));return r}function S(t){for(var r=$t.zeros(1,t.columns),e=0;e<t.rows;++e)for(var n=0;n<t.columns;++n)r.set(0,n,r.get(0,n)+t.get(e,n));return r}function R(t,r){if("number"!=typeof r)throw new TypeError("".concat(t," must be a number"))}function j(t){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _(t,r){return(_=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function P(t,r){return!r||"object"!==j(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function V(t){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var A=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_(t,r)}(u,t);var r,e,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=V(n);if(o){var e=V(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return P(this,t)});function u(t,r,e){var n;return function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this)).matrix=t,n.rows=r,n.columns=e,n}return r=u,null,(e=[{key:Symbol.species,get:function(){return $t}}])&&E(r,e),u}(Nt());function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function T(t,r){return(T=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function B(t,r){return!r||"object"!==C(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function q(t){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var D=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&T(t,r)}(u,t);var r,e,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=q(n);if(o){var e=q(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return B(this,t)});function u(t){return function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,u),i.call(this,t,t.columns,t.rows)}return r=u,(e=[{key:"set",value:function(t,r,e){return this.matrix.set(r,t,e),this}},{key:"get",value:function(t,r){return this.matrix.get(r,t)}}])&&I(r.prototype,e),u}(A);function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function U(t,r){return(U=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function z(t,r){return!r||"object"!==N(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function Q(t){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var F=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&U(t,r)}(u,t);var r,e,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=Q(n);if(o){var e=Q(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return z(this,t)});function u(t,r){var e;return function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t,1,t.columns)).row=r,e}return r=u,(e=[{key:"set",value:function(t,r,e){return this.matrix.set(this.row,r,e),this}},{key:"get",value:function(t,r){return this.matrix.get(this.row,r)}}])&&L(r.prototype,e),u}(A);function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function H(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $(t,r){return($=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function G(t,r){return!r||"object"!==W(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function J(t){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var K=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&$(t,r)}(u,t);var r,e,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=J(n);if(o){var e=J(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return G(this,t)});function u(t,r,e,n,o){var s;return function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,u),k(t,r,e,n,o),(s=i.call(this,t,e-r+1,o-n+1)).startRow=r,s.startColumn=n,s}return r=u,(e=[{key:"set",value:function(t,r,e){return this.matrix.set(this.startRow+t,this.startColumn+r,e),this}},{key:"get",value:function(t,r){return this.matrix.get(this.startRow+t,this.startColumn+r)}}])&&H(r.prototype,e),u}(A);function X(t){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Y(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Z(t,r){return(Z=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function tt(t,r){return!r||"object"!==X(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function rt(t){return(rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var et=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Z(t,r)}(u,t);var r,e,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=rt(n);if(o){var e=rt(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return tt(this,t)});function u(t,r,e){var n;!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,u);var o=d(t,r,e);return(n=i.call(this,t,o.row.length,o.column.length)).rowIndices=o.row,n.columnIndices=o.column,n}return r=u,(e=[{key:"set",value:function(t,r,e){return this.matrix.set(this.rowIndices[t],this.columnIndices[r],e),this}},{key:"get",value:function(t,r){return this.matrix.get(this.rowIndices[t],this.columnIndices[r])}}])&&Y(r.prototype,e),u}(A);function nt(t){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ot(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function it(t,r){return(it=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function ut(t,r){return!r||"object"!==nt(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function st(t){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var at=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&it(t,r)}(u,t);var r,e,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=st(n);if(o){var e=st(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return ut(this,t)});function u(t,r){var e;return function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,u),r=x(t,r),(e=i.call(this,t,r.length,t.columns)).rowIndices=r,e}return r=u,(e=[{key:"set",value:function(t,r,e){return this.matrix.set(this.rowIndices[t],r,e),this}},{key:"get",value:function(t,r){return this.matrix.get(this.rowIndices[t],r)}}])&&ot(r.prototype,e),u}(A);function ct(t){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ft(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function lt(t,r){return(lt=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function ht(t,r){return!r||"object"!==ct(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function yt(t){return(yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var pt=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&lt(t,r)}(u,t);var r,e,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=yt(n);if(o){var e=yt(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return ht(this,t)});function u(t,r){var e;return function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,u),r=M(t,r),(e=i.call(this,t,t.rows,r.length)).columnIndices=r,e}return r=u,(e=[{key:"set",value:function(t,r,e){return this.matrix.set(t,this.columnIndices[r],e),this}},{key:"get",value:function(t,r){return this.matrix.get(t,this.columnIndices[r])}}])&&ft(r.prototype,e),u}(A);function vt(t){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mt(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function bt(t,r){return(bt=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function wt(t,r){return!r||"object"!==vt(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function gt(t){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var dt=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&bt(t,r)}(u,t);var r,e,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=gt(n);if(o){var e=gt(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return wt(this,t)});function u(t,r){var e;return function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,t,t.rows,1)).column=r,e}return r=u,(e=[{key:"set",value:function(t,r,e){return this.matrix.set(t,this.column,e),this}},{key:"get",value:function(t){return this.matrix.get(t,this.column)}}])&&mt(r.prototype,e),u}(A);function xt(t){return(xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mt(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kt(t,r){return(kt=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function Ot(t,r){return!r||"object"!==xt(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function St(t){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Rt=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&kt(t,r)}(u,t);var r,e,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=St(n);if(o){var e=St(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return Ot(this,t)});function u(t){return function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,u),i.call(this,t,t.rows,t.columns)}return r=u,(e=[{key:"set",value:function(t,r,e){return this.matrix.set(this.rows-t-1,r,e),this}},{key:"get",value:function(t,r){return this.matrix.get(this.rows-t-1,r)}}])&&Mt(r.prototype,e),u}(A);function jt(t){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Et(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _t(t,r){return(_t=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function Pt(t,r){return!r||"object"!==jt(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function Vt(t){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var At=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_t(t,r)}(u,t);var r,e,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=Vt(n);if(o){var e=Vt(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return Pt(this,t)});function u(t){return function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,u),i.call(this,t,t.rows,t.columns)}return r=u,(e=[{key:"set",value:function(t,r,e){return this.matrix.set(t,this.columns-r-1,e),this}},{key:"get",value:function(t,r){return this.matrix.get(t,this.columns-r-1)}}])&&Et(r.prototype,e),u}(A);function Ct(t){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function It(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Tt(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Bt(t,r){return(Bt=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function qt(t,r){return!r||"object"!==Ct(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function Dt(t){return(Dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nt(t){void 0===t&&(t=Object);var r=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Bt(t,r)}(f,t);var r,n,o,i,u,a=(i=f,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=Dt(i);if(u){var e=Dt(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return qt(this,t)});function f(){return It(this,f),a.apply(this,arguments)}return r=f,n=[{key:"size",get:function(){return this.rows*this.columns}},{key:"apply",value:function(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var r=this.rows,e=this.columns,n=0;n<r;n++)for(var o=0;o<e;o++)t.call(this,n,o);return this}},{key:"to1DArray",value:function(){for(var t=new Array(this.size),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t[r*this.columns+e]=this.get(r,e);return t}},{key:"to2DArray",value:function(){for(var t=new Array(this.rows),r=0;r<this.rows;r++){t[r]=new Array(this.columns);for(var e=0;e<this.columns;e++)t[r][e]=this.get(r,e)}return t}},{key:"isRowVector",value:function(){return 1===this.rows}},{key:"isColumnVector",value:function(){return 1===this.columns}},{key:"isVector",value:function(){return 1===this.rows||1===this.columns}},{key:"isSquare",value:function(){return this.rows===this.columns}},{key:"isSymmetric",value:function(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var r=0;r<=t;r++)if(this.get(t,r)!==this.get(r,t))return!1;return!0}return!1}},{key:"set",value:function(t,r,e){throw new Error("set method is unimplemented")}},{key:"get",value:function(t,r){throw new Error("get method is unimplemented")}},{key:"repeat",value:function(t,r){t=t||1,r=r||1;for(var e=new this.constructor[Symbol.species](this.rows*t,this.columns*r),n=0;n<t;n++)for(var o=0;o<r;o++)e.setSubMatrix(this,this.rows*n,this.columns*o);return e}},{key:"fill",value:function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,t);return this}},{key:"neg",value:function(){return this.mulS(-1)}},{key:"getRow",value:function(t){m(this,t);for(var r=new Array(this.columns),e=0;e<this.columns;e++)r[e]=this.get(t,e);return r}},{key:"getRowVector",value:function(t){return this.constructor.rowVector(this.getRow(t))}},{key:"setRow",value:function(t,r){m(this,t),r=w(this,r);for(var e=0;e<this.columns;e++)this.set(t,e,r[e]);return this}},{key:"swapRows",value:function(t,r){m(this,t),m(this,r);for(var e=0;e<this.columns;e++){var n=this.get(t,e);this.set(t,e,this.get(r,e)),this.set(r,e,n)}return this}},{key:"getColumn",value:function(t){b(this,t);for(var r=new Array(this.rows),e=0;e<this.rows;e++)r[e]=this.get(e,t);return r}},{key:"getColumnVector",value:function(t){return this.constructor.columnVector(this.getColumn(t))}},{key:"setColumn",value:function(t,r){b(this,t),r=g(this,r);for(var e=0;e<this.rows;e++)this.set(e,t,r[e]);return this}},{key:"swapColumns",value:function(t,r){b(this,t),b(this,r);for(var e=0;e<this.rows;e++){var n=this.get(e,t);this.set(e,t,this.get(e,r)),this.set(e,r,n)}return this}},{key:"addRowVector",value:function(t){t=w(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[e]);return this}},{key:"subRowVector",value:function(t){t=w(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[e]);return this}},{key:"mulRowVector",value:function(t){t=w(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[e]);return this}},{key:"divRowVector",value:function(t){t=w(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[e]);return this}},{key:"addColumnVector",value:function(t){t=g(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[r]);return this}},{key:"subColumnVector",value:function(t){t=g(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[r]);return this}},{key:"mulColumnVector",value:function(t){t=g(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[r]);return this}},{key:"divColumnVector",value:function(t){t=g(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[r]);return this}},{key:"mulRow",value:function(t,r){m(this,t);for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r);return this}},{key:"mulColumn",value:function(t,r){b(this,t);for(var e=0;e<this.rows;e++)this.set(e,t,this.get(e,t)*r);return this}},{key:"max",value:function(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)>t&&(t=this.get(r,e));return t}},{key:"maxIndex",value:function(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n),r[0]=e,r[1]=n);return r}},{key:"min",value:function(){for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)<t&&(t=this.get(r,e));return t}},{key:"minIndex",value:function(){for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n),r[0]=e,r[1]=n);return r}},{key:"maxRow",value:function(t){m(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)>r&&(r=this.get(t,e));return r}},{key:"maxRowIndex",value:function(t){m(this,t);for(var r=this.get(t,0),e=[t,0],n=1;n<this.columns;n++)this.get(t,n)>r&&(r=this.get(t,n),e[1]=n);return e}},{key:"minRow",value:function(t){m(this,t);for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)<r&&(r=this.get(t,e));return r}},{key:"minRowIndex",value:function(t){m(this,t);for(var r=this.get(t,0),e=[t,0],n=1;n<this.columns;n++)this.get(t,n)<r&&(r=this.get(t,n),e[1]=n);return e}},{key:"maxColumn",value:function(t){b(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)>r&&(r=this.get(e,t));return r}},{key:"maxColumnIndex",value:function(t){b(this,t);for(var r=this.get(0,t),e=[0,t],n=1;n<this.rows;n++)this.get(n,t)>r&&(r=this.get(n,t),e[0]=n);return e}},{key:"minColumn",value:function(t){b(this,t);for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)<r&&(r=this.get(e,t));return r}},{key:"minColumnIndex",value:function(t){b(this,t);for(var r=this.get(0,t),e=[0,t],n=1;n<this.rows;n++)this.get(n,t)<r&&(r=this.get(n,t),e[0]=n);return e}},{key:"diag",value:function(){for(var t=Math.min(this.rows,this.columns),r=new Array(t),e=0;e<t;e++)r[e]=this.get(e,e);return r}},{key:"sum",value:function(t){switch(t){case"row":return O(this);case"column":return S(this);default:return function(t){for(var r=0,e=0;e<t.rows;e++)for(var n=0;n<t.columns;n++)r+=t.get(e,n);return r}(this)}}},{key:"mean",value:function(){return this.sum()/this.size}},{key:"prod",value:function(){for(var t=1,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t*=this.get(r,e);return t}},{key:"norm",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frobenius",r=0;if("max"===t)return this.max();if("frobenius"===t){for(var e=0;e<this.rows;e++)for(var n=0;n<this.columns;n++)r+=this.get(e,n)*this.get(e,n);return Math.sqrt(r)}throw new RangeError("unknown norm type: ".concat(t))}},{key:"cumulativeSum",value:function(){for(var t=0,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t+=this.get(r,e),this.set(r,e,t);return this}},{key:"dot",value:function(t){f.isMatrix(t)&&(t=t.to1DArray());var r=this.to1DArray();if(r.length!==t.length)throw new RangeError("vectors do not have the same size");for(var e=0,n=0;n<r.length;n++)e+=r[n]*t[n];return e}},{key:"mmul",value:function(t){t=this.constructor.checkMatrix(t),this.columns!==t.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var r=this.rows,e=this.columns,n=t.columns,o=new this.constructor[Symbol.species](r,n),i=new Array(e),u=0;u<n;u++){for(var s=0;s<e;s++)i[s]=t.get(s,u);for(var a=0;a<r;a++){var c=0;for(s=0;s<e;s++)c+=this.get(a,s)*i[s];o.set(a,u,c)}}return o}},{key:"strassen2x2",value:function(t){var r=new this.constructor[Symbol.species](2,2),e=this.get(0,0),n=t.get(0,0),o=this.get(0,1),i=t.get(0,1),u=this.get(1,0),s=t.get(1,0),a=this.get(1,1),c=t.get(1,1),f=(e+a)*(n+c),l=(u+a)*n,h=e*(i-c),y=a*(s-n),p=(e+o)*c,v=f+y-p+(o-a)*(s+c),m=h+p,b=l+y,w=f-l+h+(u-e)*(n+i);return r.set(0,0,v),r.set(0,1,m),r.set(1,0,b),r.set(1,1,w),r}},{key:"strassen3x3",value:function(t){var r=new this.constructor[Symbol.species](3,3),e=this.get(0,0),n=this.get(0,1),o=this.get(0,2),i=this.get(1,0),u=this.get(1,1),s=this.get(1,2),a=this.get(2,0),c=this.get(2,1),f=this.get(2,2),l=t.get(0,0),h=t.get(0,1),y=t.get(0,2),p=t.get(1,0),v=t.get(1,1),m=t.get(1,2),b=t.get(2,0),w=t.get(2,1),g=t.get(2,2),d=(e-i)*(-h+v),x=(-e+i+u)*(l-h+v),M=(i+u)*(-l+h),k=e*l,O=(-e+a+c)*(l-y+m),S=(-e+a)*(y-m),R=(a+c)*(-l+y),j=(-o+c+f)*(v+b-w),E=(o-f)*(v-w),_=o*b,P=(c+f)*(-b+w),V=(-o+u+s)*(m+b-g),A=(o-s)*(m-g),C=(u+s)*(-b+g),I=k+_+n*p,T=(e+n+o-i-u-c-f)*v+x+M+k+j+_+P,B=k+O+R+(e+n+o-u-s-a-c)*m+_+V+C,q=d+u*(-l+h+p-v-m-b+g)+x+k+_+V+A,D=d+x+M+k+s*w,N=_+V+A+C+i*y,L=k+O+S+c*(-l+y+p-v-m-b+w)+j+E+_,U=j+E+_+P+a*h,z=k+O+S+R+f*g;return r.set(0,0,I),r.set(0,1,T),r.set(0,2,B),r.set(1,0,q),r.set(1,1,D),r.set(1,2,N),r.set(2,0,L),r.set(2,1,U),r.set(2,2,z),r}},{key:"mmulStrassen",value:function(t){var r=this.clone(),e=r.rows,n=r.columns,o=t.rows,i=t.columns;function u(t,r,e){var n=t.rows,o=t.columns;if(n===r&&o===e)return t;var i=f.zeros(r,e);return i.setSubMatrix(t,0,0)}n!==o&&console.warn("Multiplying ".concat(e," x ").concat(n," and ").concat(o," x ").concat(i," matrix: dimensions do not match."));var s=Math.max(e,o),a=Math.max(n,i);return function t(r,e,n,o){if(n<=512||o<=512)return r.mmul(e);n%2==1&&o%2==1?(r=u(r,n+1,o+1),e=u(e,n+1,o+1)):n%2==1?(r=u(r,n+1,o),e=u(e,n+1,o)):o%2==1&&(r=u(r,n,o+1),e=u(e,n,o+1));var i=parseInt(r.rows/2,10),s=parseInt(r.columns/2,10),a=r.subMatrix(0,i-1,0,s-1),c=e.subMatrix(0,i-1,0,s-1),l=r.subMatrix(0,i-1,s,r.columns-1),h=e.subMatrix(0,i-1,s,e.columns-1),y=r.subMatrix(i,r.rows-1,0,s-1),p=e.subMatrix(i,e.rows-1,0,s-1),v=r.subMatrix(i,r.rows-1,s,r.columns-1),m=e.subMatrix(i,e.rows-1,s,e.columns-1),b=t(f.add(a,v),f.add(c,m),i,s),w=t(f.add(y,v),c,i,s),g=t(a,f.sub(h,m),i,s),d=t(v,f.sub(p,c),i,s),x=t(f.add(a,l),m,i,s),M=t(f.sub(y,a),f.add(c,h),i,s),k=t(f.sub(l,v),f.add(p,m),i,s),O=f.add(b,d);O.sub(x),O.add(k);var S=f.add(g,x),R=f.add(w,d),j=f.sub(b,w);j.add(g),j.add(M);var E=f.zeros(2*O.rows,2*O.columns);return(E=(E=(E=(E=E.setSubMatrix(O,0,0)).setSubMatrix(S,O.rows,0)).setSubMatrix(R,0,O.columns)).setSubMatrix(j,O.rows,O.columns)).subMatrix(0,n-1,0,o-1)}(r=u(r,s,a),t=u(t,s,a),s,a)}},{key:"scaleRows",value:function(t,r){if((t=void 0===t?0:t)>=(r=void 0===r?1:r))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),n=0;n<this.rows;n++){var o=s(this.getRow(n),{min:t,max:r});e.setRow(n,o)}return e}},{key:"scaleColumns",value:function(t,r){if((t=void 0===t?0:t)>=(r=void 0===r?1:r))throw new RangeError("min should be strictly smaller than max");for(var e=this.constructor.empty(this.rows,this.columns),n=0;n<this.columns;n++){var o=s(this.getColumn(n),{min:t,max:r});e.setColumn(n,o)}return e}},{key:"kroneckerProduct",value:function(t){t=this.constructor.checkMatrix(t);for(var r=this.rows,e=this.columns,n=t.rows,o=t.columns,i=new this.constructor[Symbol.species](r*n,e*o),u=0;u<r;u++)for(var s=0;s<e;s++)for(var a=0;a<n;a++)for(var c=0;c<o;c++)i[n*u+a][o*s+c]=this.get(u,s)*t.get(a,c);return i}},{key:"transpose",value:function(){for(var t=new this.constructor[Symbol.species](this.columns,this.rows),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(e,r,this.get(r,e));return t}},{key:"sortRows",value:function(t){void 0===t&&(t=e);for(var r=0;r<this.rows;r++)this.setRow(r,this.getRow(r).sort(t));return this}},{key:"sortColumns",value:function(t){void 0===t&&(t=e);for(var r=0;r<this.columns;r++)this.setColumn(r,this.getColumn(r).sort(t));return this}},{key:"subMatrix",value:function(t,r,e,n){k(this,t,r,e,n);for(var o=new this.constructor[Symbol.species](r-t+1,n-e+1),i=t;i<=r;i++)for(var u=e;u<=n;u++)o[i-t][u-e]=this.get(i,u);return o}},{key:"subMatrixRow",value:function(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.columns-1),r>e||r<0||r>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](t.length,e-r+1),o=0;o<t.length;o++)for(var i=r;i<=e;i++){if(t[o]<0||t[o]>=this.rows)throw new RangeError("Row index out of range: ".concat(t[o]));n.set(o,i-r,this.get(t[o],i))}return n}},{key:"subMatrixColumn",value:function(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.rows-1),r>e||r<0||r>=this.rows||e<0||e>=this.rows)throw new RangeError("Argument out of range");for(var n=new this.constructor[Symbol.species](e-r+1,t.length),o=0;o<t.length;o++)for(var i=r;i<=e;i++){if(t[o]<0||t[o]>=this.columns)throw new RangeError("Column index out of range: ".concat(t[o]));n.set(i-r,o,this.get(i,t[o]))}return n}},{key:"setSubMatrix",value:function(t,r,e){k(this,r,r+(t=this.constructor.checkMatrix(t)).rows-1,e,e+t.columns-1);for(var n=0;n<t.rows;n++)for(var o=0;o<t.columns;o++)this[r+n][e+o]=t.get(n,o);return this}},{key:"selection",value:function(t,r){for(var e=d(this,t,r),n=new this.constructor[Symbol.species](t.length,r.length),o=0;o<e.row.length;o++)for(var i=e.row[o],u=0;u<e.column.length;u++){var s=e.column[u];n[o][u]=this.get(i,s)}return n}},{key:"trace",value:function(){for(var t=Math.min(this.rows,this.columns),r=0,e=0;e<t;e++)r+=this.get(e,e);return r}},{key:"transposeView",value:function(){return new D(this)}},{key:"rowView",value:function(t){return m(this,t),new F(this,t)}},{key:"columnView",value:function(t){return b(this,t),new dt(this,t)}},{key:"flipRowView",value:function(){return new Rt(this)}},{key:"flipColumnView",value:function(){return new At(this)}},{key:"subMatrixView",value:function(t,r,e,n){return new K(this,t,r,e,n)}},{key:"selectionView",value:function(t,r){return new et(this,t,r)}},{key:"rowSelectionView",value:function(t){return new at(this,t)}},{key:"columnSelectionView",value:function(t){return new pt(this,t)}},{key:"det",value:function(){var t,r,e,n,o,i;if(this.isSquare())return 2===this.columns?(t=this.get(0,0),r=this.get(0,1),e=this.get(1,0),t*this.get(1,1)-r*e):3===this.columns?(n=this.selectionView([1,2],[1,2]),o=this.selectionView([1,2],[0,2]),i=this.selectionView([1,2],[0,1]),t=this.get(0,0),r=this.get(0,1),e=this.get(0,2),t*n.det()-r*o.det()+e*i.det()):new c(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}},{key:"pseudoInverse",value:function(t){void 0===t&&(t=Number.EPSILON);for(var r=new p(this,{autoTranspose:!0}),e=r.leftSingularVectors,n=r.rightSingularVectors,o=r.diagonal,i=0;i<o.length;i++)Math.abs(o[i])>t?o[i]=1/o[i]:o[i]=0;return o=this.constructor[Symbol.species].diag(o),n.mmul(o.mmul(e.transposeView()))}},{key:"clone",value:function(){for(var t=new this.constructor[Symbol.species](this.rows,this.columns),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(r,e,this.get(r,e));return t}}],o=[{key:Symbol.species,get:function(){return this}},{key:"from1DArray",value:function(t,r,e){if(t*r!==e.length)throw new RangeError("Data length does not match given dimensions");for(var n=new this(t,r),o=0;o<t;o++)for(var i=0;i<r;i++)n.set(o,i,e[o*r+i]);return n}},{key:"rowVector",value:function(t){for(var r=new this(1,t.length),e=0;e<t.length;e++)r.set(0,e,t[e]);return r}},{key:"columnVector",value:function(t){for(var r=new this(t.length,1),e=0;e<t.length;e++)r.set(e,0,t[e]);return r}},{key:"empty",value:function(t,r){return new this(t,r)}},{key:"zeros",value:function(t,r){return this.empty(t,r).fill(0)}},{key:"ones",value:function(t,r){return this.empty(t,r).fill(1)}},{key:"rand",value:function(t,r,e){void 0===e&&(e=Math.random);for(var n=this.empty(t,r),o=0;o<t;o++)for(var i=0;i<r;i++)n.set(o,i,e());return n}},{key:"randInt",value:function(t,r,e,n){void 0===e&&(e=1e3),void 0===n&&(n=Math.random);for(var o=this.empty(t,r),i=0;i<t;i++)for(var u=0;u<r;u++){var s=Math.floor(n()*e);o.set(i,u,s)}return o}},{key:"eye",value:function(t,r,e){void 0===r&&(r=t),void 0===e&&(e=1);for(var n=Math.min(t,r),o=this.zeros(t,r),i=0;i<n;i++)o.set(i,i,e);return o}},{key:"diag",value:function(t,r,e){var n=t.length;void 0===r&&(r=n),void 0===e&&(e=r);for(var o=Math.min(n,r,e),i=this.zeros(r,e),u=0;u<o;u++)i.set(u,u,t[u]);return i}},{key:"min",value:function(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,n=t.columns,o=new this(e,n),i=0;i<e;i++)for(var u=0;u<n;u++)o.set(i,u,Math.min(t.get(i,u),r.get(i,u)));return o}},{key:"max",value:function(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,n=t.columns,o=new this(e,n),i=0;i<e;i++)for(var u=0;u<n;u++)o.set(i,u,Math.max(t.get(i,u),r.get(i,u)));return o}},{key:"checkMatrix",value:function(t){return f.isMatrix(t)?t:new this(t)}},{key:"isMatrix",value:function(t){return null!=t&&"Matrix"===t.klass}}],n&&Tt(r.prototype,n),o&&Tt(r,o),f}(t);function e(t,r){return t-r}r.prototype.klass="Matrix",r.random=r.rand,r.diagonal=r.diag,r.prototype.diagonal=r.prototype.diag,r.identity=r.eye,r.prototype.negate=r.prototype.neg,r.prototype.tensorProduct=r.prototype.kroneckerProduct,r.prototype.determinant=r.prototype.det;for(var n,o=eval,i=0,u=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]];i<u.length;i++){var a=u[i],f=o(U("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",{name:a[1],op:a[0]})),l=o(U("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",{name:"".concat(a[1],"S"),op:a[0]})),h=o(U("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",{name:"".concat(a[1],"M"),op:a[0]})),y=o(U("\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",{name:a[1]}));for(n=1;n<a.length;n++)r.prototype[a[n]]=f,r.prototype["".concat(a[n],"S")]=l,r.prototype["".concat(a[n],"M")]=h,r[a[n]]=y}var v=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach((function(t){v.push(["Math.".concat(t),t])}));for(var x=0,M=v;x<M.length;x++){var R=M[x],j=o(U("\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",{name:R[1],method:R[0]})),E=o(U("\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",{name:R[1]}));for(n=1;n<R.length;n++)r.prototype[R[n]]=j,r[R[n]]=E}for(var _=0,P=[["Math.pow",1,"pow"]];_<P.length;_++){var V=P[_],A="arg0";for(n=1;n<V[1];n++)A+=", arg".concat(n);if(1!==V[1]){var C=o(U("\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",{name:V[2],method:V[0],args:A})),I=o(U("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",{name:V[2],args:A}));for(n=2;n<V.length;n++)r.prototype[V[n]]=C,r[V[n]]=I}else{var T={name:V[2],args:A,method:V[0]},B=o(U("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",T)),q=o(U("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",T)),N=o(U("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",T)),L=o(U("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",T));for(n=2;n<V.length;n++)r.prototype[V[n]]=B,r.prototype["".concat(V[n],"M")]=N,r.prototype["".concat(V[n],"S")]=q,r[V[n]]=L}}function U(t,r){for(var e in r)t=t.replace(new RegExp("%".concat(e,"%"),"g"),r[e]);return t}return r}function Lt(t){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ut(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function zt(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Qt(t,r){return(Qt=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function Ft(t,r){return!r||"object"!==Lt(r)&&"function"!=typeof r?Wt(t):r}function Wt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ht(t){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $t=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Qt(t,r)}(u,t);var r,e,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=Ht(n);if(o){var e=Ht(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return Ft(this,t)});function u(t,r){var e,n;if(Ut(this,u),1===arguments.length&&"number"==typeof t)return Ft(e,new Array(t));if(u.isMatrix(t))return Ft(e,t.clone());if(Number.isInteger(t)&&t>0){if(e=i.call(this,t),!(Number.isInteger(r)&&r>0))throw new TypeError("nColumns must be a positive integer");for(n=0;n<t;n++)e[n]=new Array(r)}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");var o=t;if(t=o.length,"number"!=typeof(r=o[0].length)||0===r)throw new TypeError("Data must be a 2D array with at least one element");for(e=i.call(this,t),n=0;n<t;n++){if(o[n].length!==r)throw new RangeError("Inconsistent array dimensions");e[n]=[].concat(o[n])}}return e.rows=t,e.columns=r,Ft(e,Wt(e))}return r=u,(e=[{key:"set",value:function(t,r,e){return this[t][r]=e,this}},{key:"get",value:function(t,r){return this[t][r]}},{key:"removeRow",value:function(t){if(m(this,t),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(t,1),this.rows-=1,this}},{key:"addRow",value:function(t,r){return void 0===r&&(r=t,t=this.rows),m(this,t,!0),r=w(this,r),this.splice(t,0,r),this.rows+=1,this}},{key:"removeColumn",value:function(t){if(b(this,t),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var r=0;r<this.rows;r++)this[r].splice(t,1);return this.columns-=1,this}},{key:"addColumn",value:function(t,r){void 0===r&&(r=t,t=this.columns),b(this,t,!0),r=g(this,r);for(var e=0;e<this.rows;e++)this[e].splice(t,0,r[e]);return this.columns+=1,this}}])&&zt(r.prototype,e),u}(Nt(Array));function Gt(t){return(Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jt(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Kt(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Xt(t,r){return(Xt=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function Yt(t,r){return!r||"object"!==Gt(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function Zt(t){return(Zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var tr=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&Xt(t,r)}(s,t);var r,e,n,o,i,u=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=Zt(o);if(i){var e=Zt(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return Yt(this,t)});function s(t){var r,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Jt(this,s);var n=e.rows,o=void 0===n?1:n;if(t.length%o!=0)throw new Error("the data length is not divisible by the number of rows");return(r=u.call(this)).rows=o,r.columns=t.length/o,r.data=t,r}return r=s,e=[{key:"set",value:function(t,r,e){var n=this._calculateIndex(t,r);return this.data[n]=e,this}},{key:"get",value:function(t,r){var e=this._calculateIndex(t,r);return this.data[e]}},{key:"_calculateIndex",value:function(t,r){return t*this.columns+r}}],n=[{key:Symbol.species,get:function(){return $t}}],e&&Kt(r.prototype,e),n&&Kt(r,n),s}(Nt());function rr(t){return(rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function er(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function nr(t,r){return(nr=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function or(t,r){return!r||"object"!==rr(r)&&"function"!=typeof r?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function ir(t){return(ir=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ur=function(t){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&nr(t,r)}(s,t);var r,e,n,o,i,u=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,r=ir(o);if(i){var e=ir(this).constructor;t=Reflect.construct(r,arguments,e)}else t=r.apply(this,arguments);return or(this,t)});function s(t){var r;return function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,s),(r=u.call(this)).data=t,r.rows=t.length,r.columns=t[0].length,r}return r=s,e=[{key:"set",value:function(t,r,e){return this.data[t][r]=e,this}},{key:"get",value:function(t,r){return this.data[t][r]}}],n=[{key:Symbol.species,get:function(){return $t}}],e&&er(r.prototype,e),n&&er(r,n),s}(Nt());function sr(t,r){if(Array.isArray(t))return t[0]&&Array.isArray(t[0])?new ur(t):new tr(t,r);throw new Error("the argument is not an array")}function ar(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var cr=function(){function t(r){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t);var e,n,o,i,u=(r=ur.checkMatrix(r)).clone(),s=r.rows,a=r.columns,c=new Array(a);for(o=0;o<a;o++){var l=0;for(e=o;e<s;e++)l=f(l,u.get(e,o));if(0!==l){for(u.get(o,o)<0&&(l=-l),e=o;e<s;e++)u.set(e,o,u.get(e,o)/l);for(u.set(o,o,u.get(o,o)+1),n=o+1;n<a;n++){for(i=0,e=o;e<s;e++)i+=u.get(e,o)*u.get(e,n);for(i=-i/u.get(o,o),e=o;e<s;e++)u.set(e,n,u.get(e,n)+i*u.get(e,o))}}c[o]=-l}this.QR=u,this.Rdiag=c}var r,e;return r=t,(e=[{key:"solve",value:function(t){t=$t.checkMatrix(t);var r=this.QR,e=r.rows;if(t.rows!==e)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var n,o,i,u,s=t.columns,a=t.clone(),c=r.columns;for(i=0;i<c;i++)for(o=0;o<s;o++){for(u=0,n=i;n<e;n++)u+=r[n][i]*a[n][o];for(u=-u/r[i][i],n=i;n<e;n++)a[n][o]+=u*r[n][i]}for(i=c-1;i>=0;i--){for(o=0;o<s;o++)a[i][o]/=this.Rdiag[i];for(n=0;n<i;n++)for(o=0;o<s;o++)a[n][o]-=a[i][o]*r[n][i]}return a.subMatrix(0,c-1,0,s-1)}},{key:"isFullRank",value:function(){for(var t=this.QR.columns,r=0;r<t;r++)if(0===this.Rdiag[r])return!1;return!0}},{key:"upperTriangularMatrix",get:function(){var t,r,e=this.QR,n=e.columns,o=new $t(n,n);for(t=0;t<n;t++)for(r=0;r<n;r++)o[t][r]=t<r?e[t][r]:t===r?this.Rdiag[t]:0;return o}},{key:"orthogonalMatrix",get:function(){var t,r,e,n,o=this.QR,i=o.rows,u=o.columns,s=new $t(i,u);for(e=u-1;e>=0;e--){for(t=0;t<i;t++)s[t][e]=0;for(s[e][e]=1,r=e;r<u;r++)if(0!==o[e][e]){for(n=0,t=e;t<i;t++)n+=o[t][e]*s[t][r];for(n=-n/o[e][e],t=e;t<i;t++)s[t][r]+=n*o[t][e]}}return s}}])&&ar(r.prototype,e),t}();function fr(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t=ur.checkMatrix(t),r?new p(t).inverse():lr(t,$t.eye(t.rows))}function lr(t,r){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t=ur.checkMatrix(t),r=ur.checkMatrix(r),e?new p(t).solve(r):t.isSquare()?new c(t).solve(r):new cr(t).solve(r)}function hr(t,r){for(var e=[],n=0;n<t;n++)n!==r&&e.push(n);return e}function yr(t,r,e){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-9,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e-9;if(t>o)return new Array(r.rows+1).fill(0);for(var i=r.addRow(e,[0]),u=0;u<i.rows;u++)Math.abs(i.get(u,0))<n&&i.set(u,0,0);return i.to1DArray()}function pr(t){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=r.thresholdValue,n=void 0===e?1e-9:e,o=r.thresholdError,u=void 0===o?1e-9:o,s=t.rows,a=new $t(s,s),c=0;c<s;c++){var f=$t.columnVector(t.getRow(c)),l=t.subMatrixRow(hr(s,c)).transposeView(),h=new p(l),y=h.solve(f),v=i($t.sub(f,l.mmul(y)).abs().to1DArray());a.setRow(c,yr(v,y,c,n,u))}return a}function vr(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function mr(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var br=function(){function t(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vr(this,t);var n=e.assumeSymmetric,o=void 0!==n&&n;if(!(r=ur.checkMatrix(r)).isSquare())throw new Error("Matrix is not a square matrix");var i,u,s=r.columns,a=l(s,s,0),c=new Array(s),f=new Array(s),h=r;if(o||r.isSymmetric()){for(i=0;i<s;i++)for(u=0;u<s;u++)a[i][u]=h.get(i,u);wr(s,f,c,a),gr(s,f,c,a)}else{var y=l(s,s,0),p=new Array(s);for(u=0;u<s;u++)for(i=0;i<s;i++)y[i][u]=h.get(i,u);dr(s,y,p,a),xr(s,f,c,a,y)}this.n=s,this.e=f,this.d=c,this.V=a}var r,e;return r=t,(e=[{key:"realEigenvalues",get:function(){return this.d}},{key:"imaginaryEigenvalues",get:function(){return this.e}},{key:"eigenvectorMatrix",get:function(){return $t.isMatrix(this.V)||(this.V=new $t(this.V)),this.V}},{key:"diagonalMatrix",get:function(){var t,r,e=this.n,n=this.e,o=this.d,i=new $t(e,e);for(t=0;t<e;t++){for(r=0;r<e;r++)i[t][r]=0;i[t][t]=o[t],n[t]>0?i[t][t+1]=n[t]:n[t]<0&&(i[t][t-1]=n[t])}return i}}])&&mr(r.prototype,e),t}();function wr(t,r,e,n){var o,i,u,s,a,c,f,l;for(a=0;a<t;a++)e[a]=n[t-1][a];for(s=t-1;s>0;s--){for(l=0,u=0,c=0;c<s;c++)l+=Math.abs(e[c]);if(0===l)for(r[s]=e[s-1],a=0;a<s;a++)e[a]=n[s-1][a],n[s][a]=0,n[a][s]=0;else{for(c=0;c<s;c++)e[c]/=l,u+=e[c]*e[c];for(o=e[s-1],i=Math.sqrt(u),o>0&&(i=-i),r[s]=l*i,u-=o*i,e[s-1]=o-i,a=0;a<s;a++)r[a]=0;for(a=0;a<s;a++){for(o=e[a],n[a][s]=o,i=r[a]+n[a][a]*o,c=a+1;c<=s-1;c++)i+=n[c][a]*e[c],r[c]+=n[c][a]*o;r[a]=i}for(o=0,a=0;a<s;a++)r[a]/=u,o+=r[a]*e[a];for(f=o/(u+u),a=0;a<s;a++)r[a]-=f*e[a];for(a=0;a<s;a++){for(o=e[a],i=r[a],c=a;c<=s-1;c++)n[c][a]-=o*r[c]+i*e[c];e[a]=n[s-1][a],n[s][a]=0}}e[s]=u}for(s=0;s<t-1;s++){if(n[t-1][s]=n[s][s],n[s][s]=1,0!==(u=e[s+1])){for(c=0;c<=s;c++)e[c]=n[c][s+1]/u;for(a=0;a<=s;a++){for(i=0,c=0;c<=s;c++)i+=n[c][s+1]*n[c][a];for(c=0;c<=s;c++)n[c][a]-=i*e[c]}}for(c=0;c<=s;c++)n[c][s+1]=0}for(a=0;a<t;a++)e[a]=n[t-1][a],n[t-1][a]=0;n[t-1][t-1]=1,r[0]=0}function gr(t,r,e,n){var o,i,u,s,a,c,l,h,y,p,v,m,b,w,g,d;for(u=1;u<t;u++)r[u-1]=r[u];r[t-1]=0;var x=0,M=0,k=Number.EPSILON;for(c=0;c<t;c++){for(M=Math.max(M,Math.abs(e[c])+Math.abs(r[c])),l=c;l<t&&!(Math.abs(r[l])<=k*M);)l++;if(l>c)do{for(o=e[c],y=f(h=(e[c+1]-o)/(2*r[c]),1),h<0&&(y=-y),e[c]=r[c]/(h+y),e[c+1]=r[c]*(h+y),p=e[c+1],i=o-e[c],u=c+2;u<t;u++)e[u]-=i;for(x+=i,h=e[l],m=v=1,b=v,w=r[c+1],g=0,d=0,u=l-1;u>=c;u--)for(b=m,m=v,d=g,o=v*r[u],i=v*h,y=f(h,r[u]),r[u+1]=g*y,g=r[u]/y,h=(v=h/y)*e[u]-g*o,e[u+1]=i+g*(v*o+g*e[u]),a=0;a<t;a++)i=n[a][u+1],n[a][u+1]=g*n[a][u]+v*i,n[a][u]=v*n[a][u]-g*i;h=-g*d*b*w*r[c]/p,r[c]=g*h,e[c]=v*h}while(Math.abs(r[c])>k*M);e[c]=e[c]+x,r[c]=0}for(u=0;u<t-1;u++){for(a=u,h=e[u],s=u+1;s<t;s++)e[s]<h&&(a=s,h=e[s]);if(a!==u)for(e[a]=e[u],e[u]=h,s=0;s<t;s++)h=n[s][u],n[s][u]=n[s][a],n[s][a]=h}}function dr(t,r,e,n){var o,i,u,s,a,c,f,l=t-1;for(c=1;c<=l-1;c++){for(f=0,s=c;s<=l;s++)f+=Math.abs(r[s][c-1]);if(0!==f){for(u=0,s=l;s>=c;s--)e[s]=r[s][c-1]/f,u+=e[s]*e[s];for(i=Math.sqrt(u),e[c]>0&&(i=-i),u-=e[c]*i,e[c]=e[c]-i,a=c;a<t;a++){for(o=0,s=l;s>=c;s--)o+=e[s]*r[s][a];for(o/=u,s=c;s<=l;s++)r[s][a]-=o*e[s]}for(s=0;s<=l;s++){for(o=0,a=l;a>=c;a--)o+=e[a]*r[s][a];for(o/=u,a=c;a<=l;a++)r[s][a]-=o*e[a]}e[c]=f*e[c],r[c][c-1]=f*i}}for(s=0;s<t;s++)for(a=0;a<t;a++)n[s][a]=s===a?1:0;for(c=l-1;c>=1;c--)if(0!==r[c][c-1]){for(s=c+1;s<=l;s++)e[s]=r[s][c-1];for(a=c;a<=l;a++){for(i=0,s=c;s<=l;s++)i+=e[s]*n[s][a];for(i=i/e[c]/r[c][c-1],s=c;s<=l;s++)n[s][a]+=i*e[s]}}}function xr(t,r,e,n,o){var i,u,s,a,c,f,l,h,y,p,v,m,b,w,g,d=t-1,x=t-1,M=Number.EPSILON,k=0,O=0,S=0,R=0,j=0,E=0,_=0,P=0;for(i=0;i<t;i++)for((i<0||i>x)&&(e[i]=o[i][i],r[i]=0),u=Math.max(i-1,0);u<t;u++)O+=Math.abs(o[i][u]);for(;d>=0;){for(a=d;a>0&&(0===(E=Math.abs(o[a-1][a-1])+Math.abs(o[a][a]))&&(E=O),!(Math.abs(o[a][a-1])<M*E));)a--;if(a===d)o[d][d]=o[d][d]+k,e[d]=o[d][d],r[d]=0,d--,P=0;else if(a===d-1){if(l=o[d][d-1]*o[d-1][d],R=(S=(o[d-1][d-1]-o[d][d])/2)*S+l,_=Math.sqrt(Math.abs(R)),o[d][d]=o[d][d]+k,o[d-1][d-1]=o[d-1][d-1]+k,h=o[d][d],R>=0){for(_=S>=0?S+_:S-_,e[d-1]=h+_,e[d]=e[d-1],0!==_&&(e[d]=h-l/_),r[d-1]=0,r[d]=0,S=(h=o[d][d-1])/(E=Math.abs(h)+Math.abs(_)),R=_/E,S/=j=Math.sqrt(S*S+R*R),R/=j,u=d-1;u<t;u++)_=o[d-1][u],o[d-1][u]=R*_+S*o[d][u],o[d][u]=R*o[d][u]-S*_;for(i=0;i<=d;i++)_=o[i][d-1],o[i][d-1]=R*_+S*o[i][d],o[i][d]=R*o[i][d]-S*_;for(i=0;i<=x;i++)_=n[i][d-1],n[i][d-1]=R*_+S*n[i][d],n[i][d]=R*n[i][d]-S*_}else e[d-1]=h+S,e[d]=h+S,r[d-1]=_,r[d]=-_;d-=2,P=0}else{if(h=o[d][d],y=0,l=0,a<d&&(y=o[d-1][d-1],l=o[d][d-1]*o[d-1][d]),10===P){for(k+=h,i=0;i<=d;i++)o[i][i]-=h;h=y=.75*(E=Math.abs(o[d][d-1])+Math.abs(o[d-1][d-2])),l=-.4375*E*E}if(30===P&&(E=(E=(y-h)/2)*E+l)>0){for(E=Math.sqrt(E),y<h&&(E=-E),E=h-l/((y-h)/2+E),i=0;i<=d;i++)o[i][i]-=E;k+=E,h=y=l=.964}for(P+=1,c=d-2;c>=a&&(S=((j=h-(_=o[c][c]))*(E=y-_)-l)/o[c+1][c]+o[c][c+1],R=o[c+1][c+1]-_-j-E,j=o[c+2][c+1],S/=E=Math.abs(S)+Math.abs(R)+Math.abs(j),R/=E,j/=E,c!==a)&&!(Math.abs(o[c][c-1])*(Math.abs(R)+Math.abs(j))<M*(Math.abs(S)*(Math.abs(o[c-1][c-1])+Math.abs(_)+Math.abs(o[c+1][c+1]))));)c--;for(i=c+2;i<=d;i++)o[i][i-2]=0,i>c+2&&(o[i][i-3]=0);for(s=c;s<=d-1&&(w=s!==d-1,s!==c&&(S=o[s][s-1],R=o[s+1][s-1],j=w?o[s+2][s-1]:0,0!==(h=Math.abs(S)+Math.abs(R)+Math.abs(j))&&(S/=h,R/=h,j/=h)),0!==h);s++)if(E=Math.sqrt(S*S+R*R+j*j),S<0&&(E=-E),0!==E){for(s!==c?o[s][s-1]=-E*h:a!==c&&(o[s][s-1]=-o[s][s-1]),h=(S+=E)/E,y=R/E,_=j/E,R/=S,j/=S,u=s;u<t;u++)S=o[s][u]+R*o[s+1][u],w&&(S+=j*o[s+2][u],o[s+2][u]=o[s+2][u]-S*_),o[s][u]=o[s][u]-S*h,o[s+1][u]=o[s+1][u]-S*y;for(i=0;i<=Math.min(d,s+3);i++)S=h*o[i][s]+y*o[i][s+1],w&&(S+=_*o[i][s+2],o[i][s+2]=o[i][s+2]-S*j),o[i][s]=o[i][s]-S,o[i][s+1]=o[i][s+1]-S*R;for(i=0;i<=x;i++)S=h*n[i][s]+y*n[i][s+1],w&&(S+=_*n[i][s+2],n[i][s+2]=n[i][s+2]-S*j),n[i][s]=n[i][s]-S,n[i][s+1]=n[i][s+1]-S*R}}}if(0!==O){for(d=t-1;d>=0;d--)if(S=e[d],0===(R=r[d]))for(a=d,o[d][d]=1,i=d-1;i>=0;i--){for(l=o[i][i]-S,j=0,u=a;u<=d;u++)j+=o[i][u]*o[u][d];if(r[i]<0)_=l,E=j;else if(a=i,0===r[i]?o[i][d]=0!==l?-j/l:-j/(M*O):(h=o[i][i+1],y=o[i+1][i],f=(h*E-_*j)/(R=(e[i]-S)*(e[i]-S)+r[i]*r[i]),o[i][d]=f,o[i+1][d]=Math.abs(h)>Math.abs(_)?(-j-l*f)/h:(-E-y*f)/_),M*(f=Math.abs(o[i][d]))*f>1)for(u=i;u<=d;u++)o[u][d]=o[u][d]/f}else if(R<0)for(a=d-1,Math.abs(o[d][d-1])>Math.abs(o[d-1][d])?(o[d-1][d-1]=R/o[d][d-1],o[d-1][d]=-(o[d][d]-S)/o[d][d-1]):(g=Mr(0,-o[d-1][d],o[d-1][d-1]-S,R),o[d-1][d-1]=g[0],o[d-1][d]=g[1]),o[d][d-1]=0,o[d][d]=1,i=d-2;i>=0;i--){for(p=0,v=0,u=a;u<=d;u++)p+=o[i][u]*o[u][d-1],v+=o[i][u]*o[u][d];if(l=o[i][i]-S,r[i]<0)_=l,j=p,E=v;else if(a=i,0===r[i]?(g=Mr(-p,-v,l,R),o[i][d-1]=g[0],o[i][d]=g[1]):(h=o[i][i+1],y=o[i+1][i],m=(e[i]-S)*(e[i]-S)+r[i]*r[i]-R*R,b=2*(e[i]-S)*R,0===m&&0===b&&(m=M*O*(Math.abs(l)+Math.abs(R)+Math.abs(h)+Math.abs(y)+Math.abs(_))),g=Mr(h*j-_*p+R*v,h*E-_*v-R*p,m,b),o[i][d-1]=g[0],o[i][d]=g[1],Math.abs(h)>Math.abs(_)+Math.abs(R)?(o[i+1][d-1]=(-p-l*o[i][d-1]+R*o[i][d])/h,o[i+1][d]=(-v-l*o[i][d]-R*o[i][d-1])/h):(g=Mr(-j-y*o[i][d-1],-E-y*o[i][d],_,R),o[i+1][d-1]=g[0],o[i+1][d]=g[1])),M*(f=Math.max(Math.abs(o[i][d-1]),Math.abs(o[i][d])))*f>1)for(u=i;u<=d;u++)o[u][d-1]=o[u][d-1]/f,o[u][d]=o[u][d]/f}for(i=0;i<t;i++)if(i<0||i>x)for(u=i;u<t;u++)n[i][u]=o[i][u];for(u=t-1;u>=0;u--)for(i=0;i<=x;i++){for(_=0,s=0;s<=Math.min(u,x);s++)_+=n[i][s]*o[s][u];n[i][u]=_}}}function Mr(t,r,e,n){var o,i;return Math.abs(e)>Math.abs(n)?[(t+(o=n/e)*r)/(i=e+o*n),(r-o*t)/i]:[((o=e/n)*t+r)/(i=n+o*e),(o*r-t)/i]}function kr(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Or=function(){function t(r){if(function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),!(r=ur.checkMatrix(r)).isSymmetric())throw new Error("Matrix is not symmetric");var e,n,o,i=r,u=i.rows,s=new $t(u,u),a=!0;for(n=0;n<u;n++){var c=s[n],f=0;for(o=0;o<n;o++){var l=s[o],h=0;for(e=0;e<o;e++)h+=l[e]*c[e];c[o]=h=(i.get(n,o)-h)/s[o][o],f+=h*h}for(a&=(f=i.get(n,n)-f)>0,s[n][n]=Math.sqrt(Math.max(f,0)),o=n+1;o<u;o++)s[n][o]=0}if(!a)throw new Error("Matrix is not positive definite");this.L=s}var r,e;return r=t,(e=[{key:"solve",value:function(t){t=ur.checkMatrix(t);var r=this.L,e=r.rows;if(t.rows!==e)throw new Error("Matrix dimensions do not match");var n,o,i,u=t.columns,s=t.clone();for(i=0;i<e;i++)for(o=0;o<u;o++){for(n=0;n<i;n++)s[i][o]-=s[n][o]*r[i][n];s[i][o]/=r[i][i]}for(i=e-1;i>=0;i--)for(o=0;o<u;o++){for(n=i+1;n<e;n++)s[i][o]-=s[n][o]*r[n][i];s[i][o]/=r[i][i]}return s}},{key:"lowerTriangularMatrix",get:function(){return this.L}}])&&kr(r.prototype,e),t}()}},r={};function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{}};return t[n](o,o.exports,e),o.exports}e.d=(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},e.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n=e(497);Projection3d2d=n})();